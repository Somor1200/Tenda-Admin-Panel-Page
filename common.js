function getRandom(){return"?random="+Math.random()}var DeviceType={samsung:[_("Samsung"),"#4b7bc2","-88px -308px"],apple:[_("Apple"),"#909eb0"],huawei:[_("Huawei"),"#f05c57"],xiaomi:[_("XiaoMi"),"#f68330"],vivo:[_("vivo"),"#51b3e7"],oppo:[_("OPPO"),"#61d237"],meizu:[_("Meizu"),"#42c4ea"],leshi:[_("LeTV"),"#f60000"],sony:[_("Sony"),"#676767"],acer:[_("Acer"),"#61d237"],nokia:[_("Nokia"),"#239bdd","0 -396px"],asus:[_("Asus"),"#458aee","0 0"],lenovo:[_("Lenovo"),"#499ee3"],moto:[_("Moto"),"#00c2d8"],amoi:[_("Amoi"),"#1886d4"],zte:[_("ZTE"),"#4b7bc2"],google:[_("Google"),"#245bf1"],hisense:[_("Hisense"),"#00897a"],gionee:[_("Gionee"),"#e40600"],tenda:[_("Tenda"),"#ff6600"],amazon:[_("Amazon"),"#ffb709"],smartisan:[_("Smartisan"),"#e53d3c"],oneplus:[_("OnePlus"),"#e63434"],lg:[_("LG"),"#ef528c"],htc:[_("HTC"),"#83cd29"],tcl:[_("TCL"),"#f05c57"],other:[_("?"),"#92979A"]};function translateManufacturer(type){var name="";var color="";var str="";var fontStyle;str+="<span class='hostlogo logo-"+type+"'></span>";return str}var statusMsg;function setStatusMsg(){statusMsg={"0101":_("WAN port disconnected. Please connect an Ethernet cable with Internet connectivity to the port."),"0102":_("Disconnected"),"0103":_("Connecting... Detecting the Internet..."),"0104":_("Connected... Accessing the Internet..."),"0105":_("Internet is inaccessible. Please contact your ISP."),"0106":_("Connected. You can access the internet."),"0201":_("WAN port disconnected. Please connect an Ethernet cable with Internet connectivity to the port."),"0202":_("Disconnected"),"0203":_("Connecting... Detecting the Internet..."),"0204":_("Connected... Accessing the Internet..."),"0205":_("The router has obtained a valid IP address but cannot access the Internet. Please try the solutions below one by one.")+"<br/>1. <a id='cloneMac' style='text-decoration:underline;' class='text-success' href='javascript:void(0)'>"+_("Clone MAC Address")+"</a>"+_("(MAC cloning will take effect in 30 seconds.)")+"<br/>"+_("2. Reconfigure the router on another computer.")+"<br/>"+_("3. Please make sure that you have subscribed to a valid internet service. For details, consult your ISP."),"0206":_("Connected. You can access the internet."),"0207":_("IP conflict. Please change the LAN IP address."),"0208":_("Error: No response from the remote server. Please contact your ISP."),"0301":_("WAN port disconnected. Please connect an Ethernet cable with Internet connectivity to the port."),"0302":_("Disconnected"),"0303":_("Checking the user name and password... Please wait 1-5 minutes."),"0304":_("Dial-up connection succeeded. Accessing the Internet..."),"0305":_("Dial-up connection succeeded but the internet is inaccessible. Please contact your ISP."),"0306":_("Connected. You can access the internet."),"0307":_("Failed. Please confirm your user name and password and try again."),"0308":_("Error: No response from the remote server. Please contact your ISP."),"1102":_("No hotspot"),"1103":_("Bridging in WISP mode..."),"1104":_("Bridged successfully in WISP mode. Accessing the internet..."),"1105":_("Internet is inaccessible. Please contact your ISP."),"1106":_("Connected. You can access the internet."),"1107":_("The WiFi password of the upstream device is incorrect."),"1202":_("No hotspot"),"1203":_("Bridging in WISP mode..."),"1204":_("Bridged successfully in WISP mode. Accessing the internet..."),"1205":_("An IP address is obtained but the internet is inaccessible. Please contact your ISP."),"1206":_("Connected. You can access the internet."),"1207":_("IP conflict. Please change the LAN IP address."),"1208":_("Error: No response from the remote server. Please contact your ISP."),"1209":_("The WiFi password of the upstream device is incorrect."),"1302":_("No hotspot"),"1303":_("Checking the user name and password... Please wait 1-5 minutes."),"1304":_("Dial-up connection succeeded. Accessing the Internet..."),"1305":_("Dial-up connection succeeded but the internet is inaccessible. Please contact your ISP."),"1306":_("Connected. You can access the internet."),"1307":_("Failed. Please confirm your user name and password and try again."),"1308":_("Error: No response from the remote server. Please contact your ISP."),"1309":_("The WiFi password of the upstream device is incorrect."),"2102":_("No signal"),"2103":_("Bridging in Universal Repeater mode..."),"2104":_("Bridged in Universal Repeater mode"),"2202":_("No signal"),"2203":_("Bridging in Universal Repeater mode..."),"2204":_("Bridged in Universal Repeater mode"),"2302":_("No signal"),"2303":_("Bridging in Universal Repeater mode..."),"2304":_("Bridged in Universal Repeater mode"),"2107":_("The WiFi password of the upstream device is incorrect."),"2209":_("The WiFi password of the upstream device is incorrect."),"2309":_("The WiFi password of the upstream device is incorrect."),"4102":_("Connection failure"),"4104":_("Connection success"),"4202":_("Connection failure"),"4204":_("Connection success"),"4302":_("Connection failure"),"4304":_("Connection success")}}var lanWanIPConflict=false;function updateInternetConnectStatus(obj,elemID){if(!lanWanIPConflict){if(obj.lanWanIPConflict=="true"){lanWanIPConflict=true;alert(_("IP conflict! The login IP address will be changed into %s automatically.Please log in again using %s.",[obj.newLanIP,obj.newLanIP]));dynamicProgressLogic.init("reboot","",450,obj.newLanIP)}else{showWanInternetStatus(obj.wanConnectStatus,elemID)}}function showWanInternetStatus(statusCode,elemID){var str="",connectStatus,connectMsg;if(!statusCode){return false}connectStatus=statusCode.slice(1,2);connectMsg=statusCode.slice(3,7);if(connectStatus=="3"){str="text-success"}else{if(connectStatus=="2"){str="text-primary"}else{str="text-danger"}}$("#"+elemID).html(statusMsg[connectMsg]).attr("class",str);return true}}function checkIpInSameSegment(ip_lan,mask_lan,ip_wan,mask_wan){if(ip_lan===""||ip_wan===""){return false}var ip1Arr=ip_lan.split("."),ip2Arr=ip_wan.split("."),maskArr1=mask_lan.split("."),maskArr2=mask_wan.split("."),maskArr=maskArr1,i;for(i=0;i<4;i++){if(maskArr1[i]!=maskArr2[i]){if((maskArr1[i]&maskArr2[i])==maskArr1[i]){maskArr=maskArr1}else{maskArr=maskArr2}break}}for(i=0;i<4;i++){if((ip1Arr[i]&maskArr[i])!=(ip2Arr[i]&maskArr[i])){return false}}return true}function checkIsVoildIpMask(ip,mask,str){var ipArry,maskArry,len,maskArry2=[],netIndex=0,netIndex1=0,broadIndex=0,i=0;str=str||_("IP Address");ipArry=ip.split("."),maskArry=mask.split("."),len=ipArry.length;for(i=0;i<len;i++){maskArry2[i]=255-Number(maskArry[i])}for(var k=0;k<4;k++){if((ipArry[k]&maskArry[k])==0){netIndex1+=0}else{netIndex1+=1}}for(var k=0;k<4;k++){if((ipArry[k]&maskArry2[k])==0){netIndex+=0}else{netIndex+=1}}if(netIndex==0||netIndex1==0){return _("%s cannot be a network segment.",[str])}for(var j=0;j<4;j++){if((ipArry[j]|maskArry[j])==255){broadIndex+=0}else{broadIndex+=1}}if(broadIndex==0){return _("%s cannot be a broadcast address.",[str])}return}function objToString(obj){var str="",prop;for(prop in obj){str+=prop+"="+encodeURIComponent(obj[prop])+"&"}str=str.replace(/[&]$/,"");return str}function inputValue(obj,callback){var prop,tagName;for(prop in obj){if(prop&&$("#"+prop).length>0){tagName=document.getElementById(prop).tagName.toLowerCase();switch(tagName){case"input":case"select":if(document.getElementById(prop).type=="checkbox"){if(obj[prop]=="true"){document.getElementById(prop).checked=true}else{document.getElementById(prop).checked=false}}else{$("#"+prop).val(obj[prop])}break;default:if($("#"+prop).hasClass("textboxs")||$("#"+prop).hasClass("input-append")){$("#"+prop)[0].val(obj[prop])}else{$("#"+prop).text(obj[prop])}break}}else{if(prop&&$("[name='"+prop+"']").length>1){tagName=document.getElementsByName(prop)[0].tagName.toLowerCase();if(tagName==="input"){if($("[name='"+prop+"'][value='"+obj[prop]+"']").length>0){$("[name='"+prop+"'][value='"+obj[prop]+"']")[0].checked=true}}}}}if(typeof callback=="function"){callback.apply()}}function formatSeconds(value){var theTime=parseInt(value);var theTime1=0;var theTime2=0;var theTime3=0;if(theTime>60){theTime1=parseInt(theTime/60);theTime=parseInt(theTime%60);if(theTime1>60){theTime2=parseInt(theTime1/60);theTime1=parseInt(theTime1%60);if(theTime2>24){theTime3=parseInt(theTime2/24);theTime2=parseInt(theTime2%24)}}}var result=""+parseInt(theTime)+_("s");if(theTime1>0){result=""+parseInt(theTime1)+_("m")+" "+result}if(theTime2>0){result=""+parseInt(theTime2)+_("h")+" "+result}if(theTime3>0){result=""+parseInt(theTime3)+_("d")+" "+result}return result}function Encode(){var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function utf16to8(str){var out,i,len,c;out="";len=str.length;for(i=0;i<len;i++){c=str.charCodeAt(i);if((c>=1)&&(c<=127)){out+=str.charAt(i)}else{if(c>2047){out+=String.fromCharCode(224|((c>>12)&15));out+=String.fromCharCode(128|((c>>6)&63));out+=String.fromCharCode(128|((c>>0)&63))}else{out+=String.fromCharCode(192|((c>>6)&31));out+=String.fromCharCode(128|((c>>0)&63))}}}return out}function base64encode(str){var out,i,len;var c1,c2,c3;len=str.length;i=0;out="";while(i<len){c1=str.charCodeAt(i++)&255;if(i==len){out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt((c1&3)<<4);out+="==";break}c2=str.charCodeAt(i++);if(i==len){out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt(((c1&3)<<4)|((c2&240)>>4));out+=base64EncodeChars.charAt((c2&15)<<2);out+="=";break}c3=str.charCodeAt(i++);out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt(((c1&3)<<4)|((c2&240)>>4));out+=base64EncodeChars.charAt(((c2&15)<<2)|((c3&192)>>6));out+=base64EncodeChars.charAt(c3&63)}return out}return function(s){return base64encode(utf16to8(s))}}if(window.JSON){$.parseJSON=JSON.parse}function checkIsTimeOut(str){if(str.indexOf("<!DOCTYPE")!=-1){return true}return false}function addOverLay(time){time=time||0;var str="<div class='save-overlay'></div>";$("body").append(str);setTimeout(function(){$(".save-overlay").remove()},time)}function isEmptyObject(obj){var name;for(name in obj){return false}return true}function PageLogic(urlObj){var moduleArry;var _this=this;this.init=function(){moduleArry=this.modules;this.pageRunning=true;this.initEvent();for(var i=0;i<moduleArry.length;i++){if(typeof moduleArry[i].init=="function"){moduleArry[i].init()}}this.addValidate();this.getValue(urlObj.getUrl,urlObj.modules)};this.initEvent=function(){};this.reCancel=function(){_this.initValue(_this.data)};this.updateTimer=null;this.update=function(modules,time,callback){time=time||0;if(!_this.pageRunning||time==0){clearTimeout(this.updateTimer);return}clearTimeout(this.updateTimer);if(time!=0){this.updateTimer=setTimeout(function(){_this.update(modules,time,callback)},time)}if(typeof urlObj.getUrl=="string"){$.get(urlObj.getUrl+"?"+Math.random()+"&modules="+encodeURIComponent(modules),function(obj){if(checkIsTimeOut(obj)){top.location.reload(true)}try{obj=$.parseJSON(obj)}catch(e){obj={}}if(isEmptyObject(obj)){top.location.reload(true)}if(!_this.pageRunning){return}if(typeof callback=="function"){callback.apply(this,[obj])}})}};this.getValue=function(getUrl,modules){var obj={};if(!this.pageRunning){return}if(typeof getUrl=="string"){var tmpObj={},data="";if(modules){data=$.encodeFormData({random:Math.random(),modules:modules})}else{data=Math.random()}$.get(getUrl+"?"+data,_this.initValue)}};this.initValue=function(obj){var moduleName,i;if(typeof obj=="string"){if(checkIsTimeOut(obj)){top.location.reload(true)}try{obj=$.parseJSON(obj)}catch(e){obj={}}}if(isEmptyObject(obj)){top.location.reload(true)}_this.data=obj;if(!_this.pageRunning){return}for(i=0;i<moduleArry.length;i++){moduleName=moduleArry[i].moduleName;if(typeof moduleArry[i].initValue=="function"){moduleArry[i].initValue(_this.data[moduleName])}}if(mainLogic&&typeof mainLogic=="object"){mainLogic.initModuleHeight()}};this.getSubmitData=function(){var data="";var moduleData="";for(var i=0;i<moduleArry.length;i++){if(typeof moduleArry[i].getSubmitData=="function"){moduleData=moduleArry[i].getSubmitData();if(moduleData!=""){data+=moduleData+"&"}}}data=data.replace(/[&]$/,"");return data};this.addValidate=function(){this.validate=$.validate({custom:function(){var msg;for(var i=0;i<moduleArry.length;i++){if(typeof moduleArry[i].checkData=="function"){msg=moduleArry[i].checkData.apply()}if(msg){return msg}}},success:function(){_this.preSubmit()},error:function(msg){if(msg){_this.showPageMsg(msg)}}})};this.preSubmit=function(){if(typeof _this.beforeSubmit=="function"){if(!_this.beforeSubmit()){return}}var data=_this.getSubmitData();addOverLay(1000);mainLogic.showModuleMsg(_("Saving..."));$.ajax({url:urlObj.setUrl,type:"POST",data:data,success:_this.successCallback,error:_this.ajaxErrMsg})};this.successCallback=function(msg){if(checkIsTimeOut(msg)){top.location.reload(true);return}var num=$.parseJSON(msg).errCode||"-1";var ip=_this.rebootIP||"";if(+num==0){mainLogic.showModuleMsg(_("Saved successfully."));_this.getValue(urlObj.getUrl,urlObj.modules)}else{if(num=="2"){mainLogic.showModuleMsg(_("Failed to change the password. Old Password is incorrect."))}else{if(num=="100"){mainLogic.hideModuleMsg();dynamicProgressLogic.init("reboot","",450,ip)}else{if(num=="101"){window.location="./login.html"}}}}$("#submit").removeAttr("disabled")};this.ajaxErrMsg=function(){_this.showPageMsg(_("Failed to upload the data."))};this.showPageMsg=function(msg){mainLogic.showModuleMsg(msg);return}}$.getData=function(getUrl,modules,callback){var obj={};if(typeof getUrl=="string"){var tmpObj={},data="";if(modules){data=$.encodeFormData({random:Math.random(),modules:modules})}else{data=Math.random()}var splitStr=getUrl.indexOf("?")==-1?"?":"&";$.get(getUrl+splitStr+data,function(dt){var obj={};try{obj=$.parseJSON(dt)}catch(e){obj={}}if(isEmptyObject(obj)){top.location.reload(true)}if(typeof callback=="function"){callback.apply(this,[obj])}})}};$.ajaxSettings.async=false;$.getData("goform/getproductInfo","productInfo",function(obj){if(obj.productInfo.ProductLNGIs==="cn"){B.setTextDomain("translate","cn",setStatusMsg)}else{B.setTextDomain("translate","",setStatusMsg)}});$.ajaxSettings.async=true;function isAllNumber(arry){var i=0,len=arry.length||0;for(i=0;i<len;i++){if(isNaN(Number(arry[i]))){return false}}return true}function isAllIp(arry){var i=0,len=arry.length||0;for(i=0;i<len;i++){if(!(/^([1-9]|[1-9]\d|1\d\d|2[0-1]\d|22[0-3])\.(([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.){2}([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$/).test(arry[i])){return false}}return true}function isAllMac(arry){var i=0,len=arry.length||0;for(i=0;i<len;i++){if(!(/^([0-9a-fA-F]{2}:){5}[0-9a-fA-F]{2}$/).test(arry[i])){return false}}return true}function reCreateObj(obj,prop,sortTag){var newObj=[],len=obj.length||0,i=0,j=0,newArry=[],arry_prop=[],temporaryObj=[],numberFlag=false,ipFlag=false,macFlag=false;for(var k=0;k<len;k++){temporaryObj[k]=obj[k]}for(i=0;i<len;i++){arry_prop[i]=temporaryObj[i][prop]}numberFlag=isAllNumber(arry_prop);ipFlag=isAllIp(arry_prop);macFlag=isAllMac(arry_prop);function sortNumber(a,b){var c=parseInt(a.replace(/[.:]/g,""),16);var d=parseInt(b.replace(/[.:]/g,""),16);return c-d}if(numberFlag||ipFlag||macFlag){newArry=arry_prop.sort(sortNumber)}else{newArry=arry_prop.sort()}for(i=0;i<len;i++){for(j=0;j<temporaryObj.length;j++){if(newArry[i]==temporaryObj[j][prop]){newObj.push(temporaryObj[j]);temporaryObj.splice(j,1);break}}}if(sortTag=="up"){return newObj}else{return newObj.reverse()}}$.include({removeValidateTipError:function(valid){return this.each(function(){var $tipElem=$("#"+this.validateTipId);if(!$tipElem){return}$("#"+this.validateTipId).parent().removeClass("has-error").removeClass("has-feedback");$("#"+this.validateTipId).remove();this.validateTipId=""})}});function Dialog(){var _this=this;this.obj={fistInit:true,data:{}};this.open=function(obj){this.obj.data=obj;if(!$("#progress-overlay").hasClass("in")){$("#progress-overlay").addClass("in")}$("#"+this.obj.data.Id).removeClass("none");$("#"+this.obj.data.Id).css("height",this.obj.data.height);if(this.obj.fistInit){$(".dialog").delegate(".dialog-close, .cancel","click",function(){_this.close()});this.obj.fistInit=false}if(typeof this.obj.data.callback=="function"){this.obj.data.callback.apply()}};this.close=function(){$("#"+this.obj.data.Id).addClass("none");$("#progress-overlay").removeClass("in")}}function getStrByteNum(str){var totalLength=0,charCode;for(var i=str.length-1;i>=0;i--){charCode=str.charCodeAt(i);if(charCode<=127){totalLength++}else{if((charCode>=128)&&(charCode<=2047)){totalLength+=2}else{if((charCode>=2048)&&(charCode<=65535)){totalLength+=3}else{totalLength+=4}}}}return totalLength}function getMaskByIp(ip){if(!ip){return}var ipFirst=ip.split(".")[0],mask="";if(!ipFirst||ipFirst<128){mask="255.0.0.0"}else{if(ipFirst<192){mask="255.255.0.0"}else{if(ipFirst<224){mask="255.255.255.0"}}}return mask}(function($,window,undefined){var _DEFAULT={title:"消息提醒",content:"消息体",isIframe:false,height:0,width:0,buttons:[],autoClose:false,timeout:60,closeCallback:function(){}};function ModalDialog(opt){this.opt=$.extend({},_DEFAULT,opt);var html='<div class="md-modal-wrap"><div class="md-modal"><div class="md-content"><h3 class="md-header"></h3><button class="md-close">×</button><div class="md-con-body"></div><div class="md-toolbar"></div></div></div></div>';this.$mask=$(html);this.$overlay=$('<div class="md-overlay"></div>');this.$title=this.$mask.find(".md-header");this.$close=this.$mask.find(".md-close");this.$content=this.$mask.find(".md-con-body");this.$footer=this.$mask.find(".md-toolbar");this.namespace="Modal_"+new Date().getTime();this.$overlay_close=this.$mask;this.$overlay_close_ie=this.$overlay;this.TIMEOUT=null;$("body").append(this.$overlay).append(this.$mask);this.init();this.bindEvets()}ModalDialog.prototype={init:function(){this.$title.text(this.opt.title);var _this=this;this.$content.html();if(this.opt.isIframe){this.iframeName="Modal_Iframe";this.iframe='<iframe src="'+this.opt.content+'" name="'+this.iframeName+'" />';this.$content.html(_this.iframe)}else{$(this.opt.content).show();this.$content.append(this.opt.content)}this.reSize();this.opt.width>0&&this.$content.css("width",this.opt.width+"px");this.opt.height>0&&this.$content.css("height",this.opt.height+"px");this.setButtons(this.opt.buttons);this.show()},getSize:function(){this.opt.MAX_Height=(window.innerHeight||(document.documentElement&&document.documentElement.clientHeight)||document.body.clientHeight)*0.8-40;this.opt.MAX_Width=(window.innerWidth||(document.documentElement&&document.documentElement.clientWidth)||document.body.clientWidth)*0.8;this.opt.buttons.length>0&&(this.opt.WIN_Height-=40)},setButtons:function(btns){if(!btns||Object.prototype.toString.call(btns)!="[object Array]"||btns.length<1){this.$footer.remove();return}var $footer=this.$footer.show(),_this=this;$footer.html("");for(var i=0,l=btns.length;i<l;i++){(function(i){var btn=btns[i],$btn=$('<button class="md-btn '+btn.theme+'">'+btn.text+"</button>");$btn.on("click",function(e){isFunction(btn.callback)&&btn.callback(e);if(btn.autoHide===false){return false}});$footer.append($btn)}(i))}_this.opt.buttons=btns},show:function(callback){this.$overlay.addClass("md-show");this.$mask.addClass("md-show");isFunction(callback)&&callback()},hide:function(callback){var _this=this;this.$overlay.removeClass("md-show");this.$mask.removeClass("md-show");isFunction(callback)&&callback();isFunction(_this.opt.closeCallback)&&_this.opt.closeCallback()},toggle:function(callback){this.$overlay.toggleClass("md-show");this.$mask.toggleClass("md-show");isFunction(callback)&&callback()},reSize:function(opt){this.getSize();this.$content.css({"max-height":this.opt.MAX_Height+"px","max-width":this.opt.MAX_Width+"px"})},setTitle:function(text){if(text){this.$title.text(text);this.opt.title=text}},refresh:function(){},bindEvets:function(){var _this=this;$(window).on("resize",function(event){if(_this.TIMEOUT){window.clearTimeout(_this.TIMEOUT);_this.TIMEOUT=null}_this.TIMEOUT=window.setTimeout(function(){_this.reSize.call(_this)},300)});_this.$close.on("click",function(e){_this.hide();return false});_this.$footer.on("click",function(e){if($(e.target).hasClass("md-btn")){_this.hide()}return false});_this.$overlay_close.on("click",function(e){if(_this.$content.hasClass("no_close_flag")){return}var event=e||window.event;var target=event.target||event.srcElement||null;if(!target){return}if(target.childNodes.length!==0&&target.childNodes[0].className=="md-modal"){_this.hide();return false}});_this.$overlay_close_ie.on("click",function(e){if(_this.$content.hasClass("no_close_flag")){return}var event=e||window.event;var target=event.target||event.srcElement||null;if(!target){return}_this.hide();return false})}};function isFunction(func){if(func&&typeof func==="function"){return true}return false}$.fn.modalDialog=function(opt){this.ModalDialog=new ModalDialog(opt);return this};$.modalDialog=function(opt){return new ModalDialog(opt)}}(jQuery,window));